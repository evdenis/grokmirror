.\" Man page generated from reStructuredText.
.
.TH GROK-PI-INDEXER 1 "2021-07-27" "2.1.0" ""
.SH NAME
GROK-PI-INDEXER \- Hook script for indexing mirrored public-inbox repos
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.SH SYNOPSIS
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.TP
.B grok\-pi\-indexer [\-h] [\-v] \-c PICONFIG \-t TOPLEVEL [\-p PITOPLEVEL]
[\-l LOGFILE] [\-L INDEXLEVEL] [\-j JOBS] [\-\-no\-fsync]
{init,update,extindex} ...
.UNINDENT
.UNINDENT
.UNINDENT
.SH DESCRIPTION
.sp
This is a helper hook for correctly initializing and indexing
public\-inbox repositories. NOTE: a working public\-inbox 1.6+ install is
required, and public\-inbox commands must be in the PATH.
.sp
The command should be invoked via grokmirror hooks, for example, use
the following grokmirror configuration file to mirror lore.kernel.org:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
[core]
toplevel = /ver/lib/git/lore.kernel.org
manifest = ${toplevel}/manifest.js.gz
log = /var/log/grokmirror/lore.kernel.org.log
loglevel = info

[remote]
site = https://lore.kernel.org
manifest = ${site}/manifest.js.gz

[pull]
default_owner = PublicInbox
pull_threads = 2
# Adjust as you see fit, or simply set to * to mirror everything
include = /git/*
          /tools/*
refresh = 60
purge = no
# If you have many CPUs and fast disks, you may want to raise \-j to a higher number
# You can also set publicinbox.indexBatchSize to a higher number in PI_CONFIG if
# you have lots of RAM, but probably not higher than 256m
post_clone_complete_hook = /usr/bin/grok\-pi\-indexer \-c /etc/public\-inbox/config \-t ${core:toplevel} init
post_update_hook = /usr/bin/grok\-pi\-indexer \-c /etc/public\-inbox/config \-t ${core:toplevel} update
# Uncomment if you\(aqve defined any [extindex] sections
#post_work_complete_hook = /usr/bin/grok\-pi\-indexer \-c /etc/public\-inbox/config \-t ${core:toplevel} extindex

[fsck]
frequency = 30
report_to = root
statusfile = ${core:toplevel}/fsck.status.js
repack = yes
commitgraph = yes
prune = yes
.ft P
.fi
.UNINDENT
.UNINDENT
.SH OPTIONS
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.TP
.B \-h\fP,\fB  \-\-help
show this help message and exit
.TP
.B \-v\fP,\fB  \-\-verbose
Be verbose and tell us what you are doing (default: False)
.TP
.BI \-c \ PICONFIG\fR,\fB \ \-\-pi\-config \ PICONFIG
Location of the public\-inbox configuration file (default: None)
.TP
.BI \-t \ TOPLEVEL\fR,\fB \ \-\-toplevel \ TOPLEVEL
Path to git repository mirror toplevel (default: None)
.TP
.BI \-p \ PITOPLEVEL\fR,\fB \ \-\-pi\-toplevel \ PITOPLEVEL
Path to public\-inbox toplevel, if separate (default: None)
.TP
.BI \-l \ LOGFILE\fR,\fB \ \-\-logfile \ LOGFILE
Log activity in this log file (default: None)
.TP
.BI \-L \ INDEXLEVEL\fR,\fB \ \-\-indexlevel \ INDEXLEVEL
Indexlevel to use with public\-inbox (full, medium, basic) (default: full)
.TP
.BI \-j \ JOBS\fR,\fB \ \-\-jobs \ JOBS
The \-\-jobs parameter to pass to public\-inbox (default: None)
.TP
.B \-\-no\-fsync
Use \-\-no\-fsync when invoking public\-inbox (default: False)
.UNINDENT
.UNINDENT
.UNINDENT
.SH SEE ALSO
.INDENT 0.0
.IP \(bu 2
grok\-pull(1)
.IP \(bu 2
public\-inbox\-init(1)
.IP \(bu 2
public\-inbox\-index(1)
.IP \(bu 2
public\-inbox\-extindex(1)
.UNINDENT
.SH SUPPORT
.sp
Email \fI\%tools@linux.kernel.org\fP\&.
.SH AUTHOR
mricon@kernel.org

License: GPLv3+
.SH COPYRIGHT
The Linux Foundation and contributors
.\" Generated by docutils manpage writer.
.
